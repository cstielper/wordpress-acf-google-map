!function(t){if(!t.fetch){var e="URLSearchParams"in t,r="Symbol"in t&&"iterator"in Symbol,s="FileReader"in t&&"Blob"in t&&function(){try{return new Blob,!0}catch(t){return!1}}(),n="FormData"in t,o="ArrayBuffer"in t;if(o)var i=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],a=function(t){return t&&DataView.prototype.isPrototypeOf(t)},d=ArrayBuffer.isView||function(t){return t&&-1<i.indexOf(Object.prototype.toString.call(t))};m.prototype.append=function(t,e){t=p(t),e=h(e);var r=this.map[t];this.map[t]=r?r+","+e:e},m.prototype.delete=function(t){delete this.map[p(t)]},m.prototype.get=function(t){return t=p(t),this.has(t)?this.map[t]:null},m.prototype.has=function(t){return this.map.hasOwnProperty(p(t))},m.prototype.set=function(t,e){this.map[p(t)]=h(e)},m.prototype.forEach=function(t,e){for(var r in this.map)this.map.hasOwnProperty(r)&&t.call(e,this.map[r],r,this)},m.prototype.keys=function(){var r=[];return this.forEach(function(t,e){r.push(e)}),u(r)},m.prototype.values=function(){var e=[];return this.forEach(function(t){e.push(t)}),u(e)},m.prototype.entries=function(){var r=[];return this.forEach(function(t,e){r.push([e,t])}),u(r)},r&&(m.prototype[Symbol.iterator]=m.prototype.entries);var c=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];k.prototype.clone=function(){return new k(this,{body:this._bodyInit})},b.call(k.prototype),b.call(O.prototype),O.prototype.clone=function(){return new O(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new m(this.headers),url:this.url})},O.error=function(){var t=new O(null,{status:0,statusText:""});return t.type="error",t};var l=[301,302,303,307,308];O.redirect=function(t,e){if(-1===l.indexOf(e))throw new RangeError("Invalid status code");return new O(null,{status:e,headers:{location:t}})},t.Headers=m,t.Request=k,t.Response=O,t.fetch=function(r,o){return new Promise(function(n,t){var e=new k(r,o),i=new XMLHttpRequest;i.onload=function(){var t,o,e={status:i.status,statusText:i.statusText,headers:(t=i.getAllResponseHeaders()||"",o=new m,t.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach(function(t){var e=t.split(":"),r=e.shift().trim();if(r){var n=e.join(":").trim();o.append(r,n)}}),o)};e.url="responseURL"in i?i.responseURL:e.headers.get("X-Request-URL");var r="response"in i?i.response:i.responseText;n(new O(r,e))},i.onerror=function(){t(new TypeError("Network request failed"))},i.ontimeout=function(){t(new TypeError("Network request failed"))},i.open(e.method,e.url,!0),"include"===e.credentials?i.withCredentials=!0:"omit"===e.credentials&&(i.withCredentials=!1),"responseType"in i&&s&&(i.responseType="blob"),e.headers.forEach(function(t,e){i.setRequestHeader(e,t)}),i.send(void 0===e._bodyInit?null:e._bodyInit)})},t.fetch.polyfill=!0}function p(t){if("string"!=typeof t&&(t=String(t)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(t))throw new TypeError("Invalid character in header field name");return t.toLowerCase()}function h(t){return"string"!=typeof t&&(t=String(t)),t}function u(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return r&&(t[Symbol.iterator]=function(){return t}),t}function m(e){this.map={},e instanceof m?e.forEach(function(t,e){this.append(e,t)},this):Array.isArray(e)?e.forEach(function(t){this.append(t[0],t[1])},this):e&&Object.getOwnPropertyNames(e).forEach(function(t){this.append(t,e[t])},this)}function f(t){if(t.bodyUsed)return Promise.reject(new TypeError("Already read"));t.bodyUsed=!0}function y(r){return new Promise(function(t,e){r.onload=function(){t(r.result)},r.onerror=function(){e(r.error)}})}function v(t){var e=new FileReader,r=y(e);return e.readAsArrayBuffer(t),r}function g(t){if(t.slice)return t.slice(0);var e=new Uint8Array(t.byteLength);return e.set(new Uint8Array(t)),e.buffer}function b(){return this.bodyUsed=!1,this._initBody=function(t){if(this._bodyInit=t)if("string"==typeof t)this._bodyText=t;else if(s&&Blob.prototype.isPrototypeOf(t))this._bodyBlob=t;else if(n&&FormData.prototype.isPrototypeOf(t))this._bodyFormData=t;else if(e&&URLSearchParams.prototype.isPrototypeOf(t))this._bodyText=t.toString();else if(o&&s&&a(t))this._bodyArrayBuffer=g(t.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer]);else{if(!o||!ArrayBuffer.prototype.isPrototypeOf(t)&&!d(t))throw new Error("unsupported BodyInit type");this._bodyArrayBuffer=g(t)}else this._bodyText="";this.headers.get("content-type")||("string"==typeof t?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):e&&URLSearchParams.prototype.isPrototypeOf(t)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},s&&(this.blob=function(){var t=f(this);if(t)return t;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?f(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(v)}),this.text=function(){var t,e,r,n=f(this);if(n)return n;if(this._bodyBlob)return t=this._bodyBlob,e=new FileReader,r=y(e),e.readAsText(t),r;if(this._bodyArrayBuffer)return Promise.resolve(function(t){for(var e=new Uint8Array(t),r=new Array(e.length),n=0;n<e.length;n++)r[n]=String.fromCharCode(e[n]);return r.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},n&&(this.formData=function(){return this.text().then(w)}),this.json=function(){return this.text().then(JSON.parse)},this}function k(t,e){var r,n,o=(e=e||{}).body;if(t instanceof k){if(t.bodyUsed)throw new TypeError("Already read");this.url=t.url,this.credentials=t.credentials,e.headers||(this.headers=new m(t.headers)),this.method=t.method,this.mode=t.mode,o||null==t._bodyInit||(o=t._bodyInit,t.bodyUsed=!0)}else this.url=String(t);if(this.credentials=e.credentials||this.credentials||"omit",!e.headers&&this.headers||(this.headers=new m(e.headers)),this.method=(r=e.method||this.method||"GET",n=r.toUpperCase(),-1<c.indexOf(n)?n:r),this.mode=e.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&o)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(o)}function w(t){var o=new FormData;return t.trim().split("&").forEach(function(t){if(t){var e=t.split("="),r=e.shift().replace(/\+/g," "),n=e.join("=").replace(/\+/g," ");o.append(decodeURIComponent(r),decodeURIComponent(n))}}),o}function O(t,e){e||(e={}),this.type="default",this.status=void 0===e.status?200:e.status,this.ok=200<=this.status&&this.status<300,this.statusText="statusText"in e?e.statusText:"OK",this.headers=new m(e.headers),this.url=e.url||"",this._initBody(t)}}("undefined"!=typeof self?self:void 0),Array.from||(Array.from=function(){var e=Object.prototype.toString,d=function(t){return"function"==typeof t||"[object Function]"===e.call(t)},n=Math.pow(2,53)-1,c=function(t){var e,r=(e=Number(t),isNaN(e)?0:0!==e&&isFinite(e)?(0<e?1:-1)*Math.floor(Math.abs(e)):e);return Math.min(Math.max(r,0),n)};return function(t){var e=Object(t);if(null==t)throw new TypeError("Array.from requires an array-like object - not null or undefined");var r,n=1<arguments.length?arguments[1]:void 0;if(void 0!==n){if(!d(n))throw new TypeError("Array.from: when provided, the second argument must be a function");2<arguments.length&&(r=arguments[2])}for(var o,i=c(e.length),s=d(this)?Object(new this(i)):new Array(i),a=0;a<i;)o=e[a],s[a]=n?void 0===r?n(o,a):n.call(r,o,a):o,a+=1;return s.length=i,s}}()),window.NodeList&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=function(t,e){e=e||window;for(var r=0;r<this.length;r++)t.call(e,this[r],r,this)});var classCallCheck=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},createClass=function(){function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),t}}(),WP_Map=function(){function It(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=t.apiKey,r=t.mapWrapper,n=void 0===r?document.getElementById("map-wrapper"):r,o=t.mapContainer,i=void 0===o?document.getElementById("map-canvas"):o,s=t.mapOptions,a=(s=void 0===s?{}:s).centerLat,d=void 0===a?39.130107:a,c=s.centerLng,l=void 0===c?-76.792481:c,p=s.zoom,h=void 0===p?15:p,u=s.mapTypeControl,m=void 0!==u&&u,f=s.scrollWheel,y=void 0!==f&&f,v=s.panControl,g=void 0!==v&&v,b=s.rotateControl,k=void 0!==b&&b,w=s.streetViewControl,O=void 0!==w&&w,M=s.zoomControl,C=void 0!==M&&M,E=s.customMapStyles,L=t.markerOptions,B=(L=void 0===L?{}:L).addCenterMarker,T=void 0===B||B,I=L.addMarkers,A=void 0!==I&&I,P=L.customCatMarkers,_=void 0!==P&&P,D=L.customSingleMarkers,W=void 0!==D&&D,x=L.markersImgPath,S=L.centerMarkerImg,F=L.centerMarkerHeight,R=void 0===F?60:F,j=L.centerMarkerWidth,U=void 0===j?60:j,H=L.centerMarkerInfoWindowContent,z=L.customMarkerImg,N=L.customMarkerWidth,q=void 0===N?40:N,V=L.customMarkerHeight,G=void 0===V?40:V,K=L.markersEndpoint,Y=t.categoryOptions,X=(Y=void 0===Y?{}:Y).addCategoryNav,J=void 0!==X&&X,Z=Y.addCategoryCount,$=void 0!==Z&&Z,Q=Y.categoriesEndpoint,tt=t.directionsOptions,et=(tt=void 0===tt?{}:tt).addDirections,rt=void 0!==et&&et,nt=tt.endingAddress,ot=void 0===nt?null:nt,it=tt.showFieldLabels,st=void 0===it||it,at=tt.startFieldLabel,dt=void 0===at?null:at,ct=tt.startFieldPlaceholder,lt=void 0===ct?null:ct,pt=tt.buttonText,ht=void 0===pt?null:pt,ut=t.resetOptions,mt=(ut=void 0===ut?{}:ut).addResetButton,ft=void 0!==mt&&mt,yt=ut.resetButtonText,vt=void 0===yt?"Reset Map":yt,gt=t.locations,bt=void 0===gt?[]:gt,kt=t.markers,wt=void 0===kt?[]:kt,Ot=t.infoWindow,Mt=void 0===Ot?null:Ot,Ct=t.directionsService,Et=void 0===Ct?null:Ct,Lt=t.directionsDisplay,Bt=void 0===Lt?null:Lt,Tt=t.resetBtn;classCallCheck(this,It),this.apiKey=e,this.mapWrapper=n,this.mapContainer=i,this.mapOptions={centerLat:d,centerLng:l,zoom:h,mapTypeControl:m,scrollWheel:y,panControl:g,rotateControl:k,streetViewControl:O,zoomControl:C,customMapStyles:E},this.markerOptions={addCenterMarker:T,addMarkers:A,customCatMarkers:_,customSingleMarkers:W,markersImgPath:x,centerMarkerImg:S,centerMarkerWidth:U,centerMarkerHeight:R,centerMarkerInfoWindowContent:H,customMarkerImg:z,customMarkerWidth:q,customMarkerHeight:G,markersEndpoint:K},this.categoryOptions={addCategoryNav:J,addCategoryCount:$,categoriesEndpoint:Q},this.directionsOptions={addDirections:rt,endingAddress:ot,showFieldLabels:st,startFieldLabel:dt,startFieldPlaceholder:lt,buttonText:ht},this.resetOptions={addResetButton:ft,resetButtonText:vt},this.locations=bt,this.markers=wt,this.infoWindow=Mt,this.directionsService=Et,this.directionsDisplay=Bt,this.resetBtn=Tt}return createClass(It,[{key:"init",value:function(){var r=this;document.addEventListener("DOMContentLoaded",function(){if(r.mapWrapper&&r.mapContainer&&r.apiKey){var t=void 0;t=document.querySelector("html").lang?document.querySelector("html").lang:"en";var e=document.createElement("script");e.type="text/javascript",e.src="https://maps.googleapis.com/maps/api/js?key="+r.apiKey+"&callback=buildMap&language="+t,document.querySelector("body").appendChild(e)}else r.mapWrapper?r.mapContainer?r.apiKey||console.error("API key not found."):console.error("Map container DOM element not found."):console.error("Map wrapper DOM element not found.")}),window.buildMap=this.buildMap.bind(this)}},{key:"buildMap",value:function(){var t=this.mapOptions.customMapStyles?this.mapOptions.customMapStyles:null,e=new google.maps.Map(this.mapContainer,{center:{lat:this.mapOptions.centerLat,lng:this.mapOptions.centerLng},styles:t,zoom:this.mapOptions.zoom,mapTypeControl:this.mapOptions.mapTypeControl,scrollwheel:this.mapOptions.scrollWheel,panControl:this.mapOptions.panControl,rotateControl:this.mapOptions.rotateControl,streetViewControl:this.mapOptions.streetViewControl,zoomControl:this.mapOptions.zoomControl,zoomControlOptions:{position:google.maps.ControlPosition.RIGHT_BOTTOM}});this.infoWindow=new google.maps.InfoWindow,this.directionsService=new google.maps.DirectionsService,this.directionsDisplay=new google.maps.DirectionsRenderer,this.directionsDisplay.setMap(e),this.markerOptions.addCenterMarker&&this.addCenterMarker(e),this.markerOptions.addMarkers&&(this.markerOptions.markersEndpoint?this.fetchMarkerData(e):console.error("You must enter an endpoint to your marker data.")),this.categoryOptions.addCategoryNav&&(this.categoryOptions.categoriesEndpoint?this.markerOptions.addMarkers?this.fetchCategoryData(e):console.error("You should have categorized markers enabled."):console.error("You must enter an endpoint to your category data.")),this.directionsOptions.addDirections&&this.createDirectionsForm(e),this.resetOptions.addResetButton&&this.createResetBtn(e)}},{key:"addCenterMarker",value:function(t){var e=this,r=null;this.markerOptions.markersImgPath&&this.markerOptions.centerMarkerImg&&(r={url:this.markerOptions.markersImgPath+this.markerOptions.centerMarkerImg,scaledSize:new google.maps.Size(this.markerOptions.centerMarkerWidth,this.markerOptions.centerMarkerHeight),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(.5*this.markerOptions.centerMarkerWidth,.5*this.markerOptions.centerMarkerHeight)});var n=this.markerOptions.centerMarkerInfoWindowContent?this.markerOptions.centerMarkerInfoWindowContent:null,o=new google.maps.Marker({position:{lat:this.mapOptions.centerLat,lng:this.mapOptions.centerLng},map:t,zIndex:1e3,icon:r,html:n});this.markerOptions.centerMarkerInfoWindowContent&&o.addListener("click",function(){null!=e.infoWindow&&e.infoWindow.close(),e.infoWindow.setContent(o.html),e.infoWindow.open(t,o)})}},{key:"fetchMarkerData",value:function(e){var r=this;fetch(this.markerOptions.markersEndpoint).then(function(t){return t.json()}).then(function(t){return r.addMarkers(e,t)}).catch(function(t){return console.error(t)})}},{key:"addMarkers",value:function(r,t){var p=this;t.forEach(function(t,e){var r=t.title.rendered,n=t.acf.address,o=t.acf.address_2,i=t.acf.phone,s=t.acf.website,a=t.acf.additional_details,d=parseFloat(t.acf.latitude),c=parseFloat(t.acf.longitude),l="cat-"+t.landmark_types[0];r=""!==r?'<strong class="window-heading">'+r+"</strong>":"",n=""!==n?"<br>"+n:"",o=""!==o?"<br>"+o:"",i=""!==i?"<br>"+i:"",s=""!==s?'<br><a target="_blank" href="'+s+'">Website &raquo;</a>':"",a=""!==a?"<br><br>"+a:"",p.locations.push({index:e,title:r,latitude:d,longitude:c,add:n,add2:o,phone:i,website:s,details:a,category:l})});var n={scaledSize:new google.maps.Size(this.markerOptions.customMarkerWidth,this.markerOptions.customMarkerHeight),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(.5*this.markerOptions.customMarkerWidth,.5*this.markerOptions.customMarkerHeight)};this.locations.forEach(function(t){p.markerOptions.customSingleMarkers&&p.markerOptions.customMarkerImg?n.url=p.markerOptions.markersImgPath+p.markerOptions.customMarkerImg:p.markerOptions.customCatMarkers?n.url=p.markerOptions.markersImgPath+t.category+".png":n=null;var e=new google.maps.Marker({position:{lat:t.latitude,lng:t.longitude},map:r,icon:n,html:t.title+"\n          "+t.add+"\n          "+t.add2+"\n          "+t.phone+"\n          "+t.website+"\n          "+t.details});p.markers.push(e),p.openInfoWindow(e,r)})}},{key:"openInfoWindow",value:function(t,e){var r=this;t.addListener("click",function(){null!=r.infoWindow&&r.infoWindow.close(),r.infoWindow.setContent(t.html),r.infoWindow.open(e,t)})}},{key:"fetchCategoryData",value:function(e){var r=this;fetch(this.categoryOptions.categoriesEndpoint).then(function(t){return t.json()}).then(function(t){return r.addCategoryNav(e,t)}).catch(function(t){return console.error(t)})}},{key:"addCategoryNav",value:function(t,e){var n=this,r=document.createElement("nav");r.id="map-nav";var o=document.createElement("ul");r.appendChild(o),this.mapWrapper.appendChild(r),e.forEach(function(t){if(0<t.count){var e=document.createElement("li");e.id="cat-"+t.id,e.classList.add(t.slug);var r=document.createElement("a");r.href="#",r.innerHTML=n.categoryOptions.addCategoryCount?'<span class="count">'+t.count+"</span>"+t.name:t.name,e.appendChild(r),o.appendChild(e),n.toggleCats(r,o,n.locations,n.markers,n.infoWindow,n.resetBtn)}}),document.querySelector("body").classList.add("has-map-cat-nav")}},{key:"toggleCats",value:function(t,e,n,o,i,s){t.addEventListener("click",function(t){t.preventDefault(),null!=i&&i.close();var r=this.parentElement.getAttribute("id");n.forEach(function(t,e){t.category===r?(o[e].setVisible(!0),o[e].setOptions({zIndex:1100})):t.category!==r&&o[e].setVisible(!1)}),Array.from(e.children).forEach(function(t){t.firstChild.classList.remove("active")}),this.classList.add("active"),s&&s.classList.add("active")})}},{key:"createDirectionsForm",value:function(e){var r=this,t=this.directionsOptions.endingAddress?this.directionsOptions.endingAddress:this.mapOptions.centerLat+", "+this.mapOptions.centerLng,n="";this.directionsOptions.showFieldLabels&&(n=this.directionsOptions.startFieldLabel?this.directionsOptions.startFieldLabel:"Starting Address:");var o=this.directionsOptions.startFieldPlaceholder?this.directionsOptions.startFieldPlaceholder:"",i=this.directionsOptions.buttonText?this.directionsOptions.buttonText:"Get Directions",s=document.createElement("form");s.id="get-directions",s.innerHTML="\n      <label>"+n+'<input id="start" type="text" placeholder="'+o+'"></label>\n      <input id="end" value="'+t+'" type="hidden">\n      <div id="map-response-panel"></div>\n      <input value="'+i+'" type="submit">\n    ',this.mapWrapper.appendChild(s),s.addEventListener("submit",function(t){r.calcRoute(s,e),t.preventDefault()}),document.querySelector("body").classList.add("has-map-directions")}},{key:"calcRoute",value:function(t,r){var n=this,e=t[0].value,o=t[1].value,i=t.children.namedItem("map-response-panel"),s={origin:e,destination:o,travelMode:"DRIVING"};""===e?(i.innerHTML="Please enter a starting address",i.classList.add("active"),i.classList.add("error")):(this.directionsDisplay.setPanel(i),this.directionsService.route(s,function(t,e){i.classList.remove("error"),i.classList.remove("active"),"OK"===e?(i.classList.add("active"),i.innerHTML="",n.directionsDisplay.setDirections(t),n.directionsDisplay.setMap(r),n.resetBtn&&n.resetBtn.classList.add("active")):(i.innerHTML="We're sorry, but an error occurred: <span>"+e+"</span>.<br>Please check your starting address and try again.",i.classList.add("error"),i.classList.add("active"))}))}},{key:"createResetBtn",value:function(t){this.resetBtn=document.createElement("button"),this.resetBtn.id="map-reset-btn",this.resetBtn.textContent=this.resetOptions.resetButtonText?this.resetOptions.resetButtonText:"Reset Map",this.mapWrapper.appendChild(this.resetBtn),window.resetMap=this.resetMap.bind(this),this.resetBtn.addEventListener("click",function(){resetMap(t,this)})}},{key:"resetMap",value:function(t,e){this.markers.forEach(function(t){t.setVisible(!0)}),t.setCenter({lat:this.mapOptions.centerLat,lng:this.mapOptions.centerLng}),t.setZoom(this.mapOptions.zoom),this.infoWindow.close(),document.querySelectorAll("#map-nav li a").forEach(function(t){t.classList.remove("active")}),e.classList.remove("active"),this.directionsDisplay.setMap(null),this.directionsDisplay.setPanel(null),document.getElementById("map-response-panel")&&(document.getElementById("map-response-panel").innerHTML="",document.getElementById("map-response-panel").classList.remove("error"),document.getElementById("map-response-panel").classList.remove("active"))}}]),It}();